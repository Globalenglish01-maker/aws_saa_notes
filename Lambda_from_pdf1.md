### ç¬¬1-1é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬1é¡µ
AWS Lambda
Itâ€™s a serverless world
--- ç¬¬1é¡µç»“æŸ ---

```

### ç¬¬2-2é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬2é¡µ
Whatâ€™s serverless?
â€¢ Serverless is a new paradigm in which the developers donâ€™t have to
manage servers anymoreâ€¦
â€¢ They just deploy code
â€¢ They just deployâ€¦ functions !
â€¢ Initially... Serverless == FaaS (Function as a Service)
â€¢ Serverless was pioneered by AWS Lambda but now also includes
anything thatâ€™s managed: â€œdatabases, messaging, storage, etc.â€
â€¢ Serverless does not mean there are no serversâ€¦
it means you just donâ€™t manage / provision / see them
--- ç¬¬2é¡µç»“æŸ ---

```

### ç¬¬3-3é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬3é¡µ
Serverless in AWS
â€¢ AWS Lambda
â€¢ DynamoDB
â€¢ AWS Cognito
â€¢ AWS API Gateway
â€¢ Amazon S3
â€¢ AWS SNS & SQS
â€¢ AWS Kinesis Data Firehose
â€¢ Aurora Serverless
â€¢ Step Functions
â€¢ Fargate
Static content
REST API
Log in
S3 bucket
API Gateway
Cognito
Users
Lambda
DynamoDB
--- ç¬¬3é¡µç»“æŸ ---

```

### ç¬¬4-4é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬4é¡µ
Why AWS Lambda
â€¢ Virtual Servers in the Cloud
â€¢ Limited by RAM and CPU
â€¢ Continuously running
â€¢ Scaling means intervention to add / remove servers
Amazon Lambda
Amazon EC2
â€¢ Virtual functions â€“ no servers to manage!
â€¢ Limited by time - short executions
â€¢ Run on-demand
â€¢ Scaling is automated!
--- ç¬¬4é¡µç»“æŸ ---

```

### ç¬¬5-5é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬5é¡µ
Benefits of AWS Lambda
â€¢ Easy Pricing:
â€¢ Pay per request and compute time
â€¢ Free tier of 1,000,000 AWS Lambda requests and 400,000 GBs of compute time
â€¢ Integrated with the whole AWS suite of services
â€¢ Integrated with many programming languages
â€¢ Easy monitoring through AWS CloudWatch
â€¢ Easy to get more resources per functions (up to 10GB of RAM!)
â€¢ Increasing RAM will also improve CPU and network!
--- ç¬¬5é¡µç»“æŸ ---

```

### ç¬¬6-6é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬6é¡µ
AWS Lambda language support
â€¢ Node.js (JavaScript)
â€¢ Python
â€¢ Java
â€¢ C# (.NET Core) / Powershell
â€¢ Ruby
â€¢ Custom Runtime API (community supported, example Rust or Golang)
â€¢ Lambda Container Image
â€¢ The container image must implement the Lambda Runtime API
â€¢ ECS / Fargate is preferred for running arbitrary Docker images
--- ç¬¬6é¡µç»“æŸ ---

```

### ç¬¬7-7é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬7é¡µ
AWS Lambda Integrations
Main ones
CloudWatch Logs
SNS
Cognito
SQS
S3
Kinesis
API Gateway
DynamoDB
CloudFront
CloudWatch Events
EventBridge
--- ç¬¬7é¡µç»“æŸ ---

```

### ç¬¬8-8é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬8é¡µ
Example: Serverless Thumbnail creation
New image in S3
AWS Lambda Function
Creates a Thumbnail
trigger
push
New thumbnail in S3
Metadata in DynamoDB
push
Image name
Image size
Creation date
etcâ€¦
--- ç¬¬8é¡µç»“æŸ ---

```

### ç¬¬9-9é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬9é¡µ
Example: Serverless CRON Job
CloudWatch Events
EventBridge
AWS Lambda Function
Perform a task
Trigger
Every 1 hour
--- ç¬¬9é¡µç»“æŸ ---

```

### ç¬¬10-10é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬10é¡µ
AWS Lambda Pricing: example
â€¢ You can find overall pricing information here:
https://aws.amazon.com/lambda/pricing/
â€¢ Pay per calls:
â€¢ First 1,000,000 requests are free
â€¢ $0.20 per 1 million requests thereafter ($0.0000002 per request)
â€¢ Pay per duration: (in increment of 1 ms)
â€¢ 400,000 GB-seconds of compute time per month for FREE
â€¢ == 400,000 seconds if function is 1GB RAM
â€¢ == 3,200,000 seconds if function is 128 MB RAM
â€¢ After that $1.00 for 600,000 GB-seconds
â€¢ It is usually very cheap to run AWS Lambda so itâ€™s very popular
--- ç¬¬10é¡µç»“æŸ ---

```

### ç¬¬11-11é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬11é¡µ
Lambda â€“ Synchronous Invocations
â€¢ Synchronous: CLI, SDK, API Gateway, Application Load Balancer
â€¢ Results is returned right away
â€¢ Error handling must happen client side (retries, exponential backoff, etcâ€¦)
invoke
proxy
Do something
Response
Response
Client
SDK/CLI
Do something
invoke
Response
API Gateway
--- ç¬¬11é¡µç»“æŸ ---

```

### ç¬¬12-12é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬12é¡µ
Lambda - Synchronous Invocations - Services
â€¢ User Invoked:
â€¢ Elastic Load Balancing (Application Load Balancer)
â€¢ Amazon API Gateway
â€¢ Amazon CloudFront (Lambda@Edge)
â€¢ Amazon S3 Batch
â€¢ Service Invoked:
â€¢ Amazon Cognito
â€¢ AWS Step Functions
â€¢ Other Services:
â€¢ Amazon Lex
â€¢ Amazon Alexa
â€¢ Amazon Kinesis Data Firehose
--- ç¬¬12é¡µç»“æŸ ---

```

### ç¬¬13-13é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬13é¡µ
Lambda Integration with ALB
â€¢ To expose a Lambda function as an HTTP(S) endpointâ€¦
â€¢ You can use the Application Load Balancer (or an API Gateway)
â€¢ The Lambda function must be registered in a target group
HTTP/HTTPS
INVOKE SYNC
Target Group
Applicaeon Load Balancer
(ALB)
Client
--- ç¬¬13é¡µç»“æŸ ---

```

### ç¬¬14-14é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬14é¡µ
ALB to Lambda: HTTP to JSON
ELB informaxon
HTTP Method & Path
Query String Parameters as Key/Value pairs
Headers as Key/Value pairs
Body (for POST, PUT...) & isBase64Encoded
Request Payload for Lambda Function
--- ç¬¬14é¡µç»“æŸ ---

```

### ç¬¬15-15é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬15é¡µ
Lambda to ALB conversions: JSON to HTTP
Status Code & Description
Headers as Key/Value pairs
Body & isBase64Encoded
Response from the Lambda Funceon
--- ç¬¬15é¡µç»“æŸ ---

```

### ç¬¬16-16é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬16é¡µ
ALB Multi-Value Headers
â€¢ ALB can support multi-value
headers (ALB setting)
â€¢ When you enable multi-value
headers, HTTP headers and
query string parameters that
are sent with multiple values
are shown as arrays within the
AWS Lambda event and
response objects.
â€queryStringParametersâ€: {â€œnameâ€: [â€œfooâ€,â€barâ€] }
Client
h~p://example.com/path?name=foo&name=bar
ALB
HTTP
JSON
Lambda
--- ç¬¬16é¡µç»“æŸ ---

```

### ç¬¬17-17é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬17é¡µ
ALB + Lambda â€“ Permissios
Lambda Resource Policy
--- ç¬¬17é¡µç»“æŸ ---

```

### ç¬¬18-18é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬18é¡µ
Lambda â€“ Asynchronous Invocations
â€¢ S3, SNS, CloudWatch Eventsâ€¦
â€¢ The events are placed in an Event Queue
â€¢ Lambda attempts to retry on errors
â€¢ 3 tries total
â€¢ 1 minute wait after 1st , then 2 minutes wait
â€¢ Make sure the processing is idempotent (in
case of retries)
â€¢ If the function is retried, you will see duplicate
logs entries in CloudWatch Logs
â€¢ Can define a DLQ (dead-letter queue) â€“ SNS
or SQS â€“ for failed processing (need correct
IAM permissions)
â€¢ Asynchronous invocations allow you to speed
up the processing if you donâ€™t need to wait for
the result (ex: you need 1000 files processed)
New ï¬le
event
SQS or SNS
DLQ for
failed processing
retries
Event Queue
Lambda Service
Funceon
read
S3 bucket
--- ç¬¬18é¡µç»“æŸ ---

```

### ç¬¬19-19é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬19é¡µ
Lambda - Asynchronous Invocations - Services
â€¢ Amazon Simple Storage Service (S3)
â€¢ Amazon Simple Notification Service (SNS)
â€¢ Amazon CloudWatch Events / EventBridge
â€¢ AWS CodeCommit (CodeCommit Trigger: new branch, new tag, new push)
â€¢ AWS CodePipeline (invoke a Lambda function during the pipeline, Lambda must callback)
----- other -----
â€¢ Amazon CloudWatch Logs (log processing)
â€¢ Amazon Simple Email Service
â€¢ AWS CloudFormation
â€¢ AWS Config
â€¢ AWS IoT
â€¢ AWS IoT Events
--- ç¬¬19é¡µç»“æŸ ---

```

### ç¬¬20-20é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬20é¡µ
CloudWatch Events / EventBridge
CRON or Rate
EventBridge Rule
AWS Lambda Function
Perform a task
Trigger
Every 1 hour
CodePipeline
EventBridge Rule
AWS Lambda Function
Perform a task
Trigger on
State Changes
--- ç¬¬20é¡µç»“æŸ ---

```

### ç¬¬21-21é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬21é¡µ
S3 Events Notiï¬cations
â€¢ S3:ObjectCreated, S3:ObjectRemoved,
S3:ObjectRestore, S3:Replicationâ€¦
â€¢ Object name filtering possible (*.jpg)
â€¢ Use case: generate thumbnails of images
uploaded to S3
â€¢ S3 event notifications typically deliver events
in seconds but can sometimes take a minute
or longer
â€¢ If two writes are made to a single non-
versioned object at the same time, it is
possible that only a single event notification
will be sent
â€¢ If you want to ensure that an event
notification is sent for every successful write,
you can enable versioning on your bucket.
Amazon S3
events
Lambda Function
SQS
Lambda Function
SNS
SQS
SQS
DLQ
async
--- ç¬¬21é¡µç»“æŸ ---

```

### ç¬¬22-22é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬22é¡µ
Simple S3 Event Pattern â€“ Metadata Sync
S3 bucket
DynamoDB Table
Table in RDS
New ï¬le event
Update metadata table
--- ç¬¬22é¡µç»“æŸ ---

```

### ç¬¬23-23é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬23é¡µ
Lambda â€“ Event Source Mapping
â€¢ Kinesis Data Streams
â€¢ SQS & SQS FIFO queue
â€¢ DynamoDB Streams
â€¢ Common denominator:
records need to be polled
from the source
â€¢ Your Lambda function is
invoked synchronously
Kinesis
Event Source Mapping
(internal)
POLL
RETURN BATCH
INVOKE WITH EVENT BATCH
Lambda Function
--- ç¬¬23é¡µç»“æŸ ---

```

### ç¬¬24-24é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬24é¡µ
Streams & Lambda (Kinesis & DynamoDB)
â€¢ An event source mapping creates an iterator for each shard, processes items in order
â€¢ Start with new items, from the beginning or from timestamp
â€¢ Processed items aren't removed from the stream (other consumers can read them)
â€¢ Low traffic: use batch window to accumulate records before processing
â€¢ You can process multiple batches in parallel
â€¢ up to 10 batches per shard
â€¢ in-order processing is still guaranteed for each partition key,
h\ps://aws.amazon.com/blogs/compute/new-aws-lambda-scaling-controls-for-kinesis-and-dynamodb-event-sources/
--- ç¬¬24é¡µç»“æŸ ---

```

### ç¬¬25-25é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬25é¡µ
Streams & Lambda â€“ Error Handling
â€¢ By default, if your function returns an error, the entire batch is
reprocessed until the function succeeds, or the items in the batch
expire.
â€¢ To ensure in-order processing, processing for the affected shard is
paused until the error is resolved
â€¢ You can configure the event source mapping to:
â€¢ discard old events
â€¢ restrict the number of retries
â€¢ split the batch on error (to work around Lambda timeout issues)
â€¢ Discarded events can go to a Destination
--- ç¬¬25é¡µç»“æŸ ---

```

### ç¬¬26-26é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬26é¡µ
Lambda â€“ Event Source Mapping
SQS & SQS FIFO
â€¢ Event Source Mapping will
poll SQS (Long Polling)
â€¢ Specify batch size (1-10
messages)
â€¢ Recommended: Set the
queue visibility timeout to
6x the timeout of your
Lambda function
â€¢ To use a DLQ
â€¢ set-up on the SQS queue,
not Lambda (DLQ for
Lambda is only for async
invocations)
â€¢ Or use a Lambda destination
for failures
SQS
Lambda
Event Source Mapping
POLL
RETURN BATCH
INVOKE WITH EVENT BATCH
Lambda Funcxon
--- ç¬¬26é¡µç»“æŸ ---

```

### ç¬¬27-27é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬27é¡µ
Queues & Lambda
â€¢ Lambda also supports in-order processing for FIFO (ï¬rst-in, ï¬rst-out) queues,
scaling up to the number of active message groups.
â€¢ For standard queues, items aren't necessarily processed in order.
â€¢ Lambda scales up to process a standard queue as quickly as possible.
â€¢ When an error occurs, batches are returned to the queue as individual items
and might be processed in a different grouping than the original batch.
â€¢ Occasionally, the event source mapping might receive the same item from
the queue twice, even if no function error occurred.
â€¢ Lambda deletes items from the queue after they're processed successfully.
â€¢ You can conï¬gure the source queue to send items to a dead-letter queue if
they can't be processed.
--- ç¬¬27é¡µç»“æŸ ---

```

### ç¬¬28-28é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬28é¡µ
Lambda Event Mapper Scaling
â€¢ Kinesis Data Streams & DynamoDB Streams:
â€¢ One Lambda invocation per stream shard
â€¢ If you use parallelization, up to 10 batches processed per shard simultaneously
â€¢ SQS Standard:
â€¢ Lambda adds 60 more instances per minute to scale up
â€¢ Up to 1000 batches of messages processed simultaneously
â€¢ SQS FIFO:
â€¢ Messages with the same GroupID will be processed in order
â€¢ The Lambda function scales to the number of active message groups
--- ç¬¬28é¡µç»“æŸ ---

```

### ç¬¬29-29é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬29é¡µ
Lambda â€“ Event and Context Objects
EventBridge
Lambda Function
invoke
Event Object
Context Object
--- ç¬¬29é¡µç»“æŸ ---

```

### ç¬¬30-30é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬30é¡µ
Lambda â€“ Event and Context Objects
â€¢ Event Object
â€¢ JSON-formatted document contains data for the function to process
â€¢ Contains information from the invoking service (e.g., EventBridge, custom, â€¦)
â€¢ Lambda runtime converts the event to an object (e.g., dict type in Python)
â€¢ Example: input arguments, invoking service arguments, â€¦
â€¢ Context Object
â€¢ Provides methods and properties that provide information about the invocation,
function, and runtime environment
â€¢ Passed to your function by Lambda at runtime
â€¢ Example: aws_request_id, function_name, memory_limit_in_mb, â€¦
--- ç¬¬30é¡µç»“æŸ ---

```

### ç¬¬31-31é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬31é¡µ
Lambda â€“ Event and Context Objects
Access Event & Context Objects using Python
--- ç¬¬31é¡µç»“æŸ ---

```

### ç¬¬32-32é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬32é¡µ
Lambda â€“ Destinations
â€¢ Nov 2019: Can configure to send result to a
destination
â€¢ Asynchronous invocations - can define destinations
for successful and failed event:
â€¢ Amazon SQS
â€¢ Amazon SNS
â€¢ AWS Lambda
â€¢ Amazon EventBridge bus
â€¢ Note: AWS recommends you use destinations instead of
DLQ now (but both can be used at the same time)
â€¢ Event Source mapping: for discarded event batches
â€¢ Amazon SQS
â€¢ Amazon SNS
â€¢ Note: you can send events to a DLQ directly from SQS
https://docs.aws.amazon.com/lambda/latest/dg/invocation-eventsourcemapping.html
h\ps://docs.aws.amazon.com/lambda/latest/dg/invoca]on-async.html
--- ç¬¬32é¡µç»“æŸ ---

```

### ç¬¬33-33é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬33é¡µ
Lambda Execution Role (IAM Role)
â€¢ Grants the Lambda function permissions to AWS services / resources
â€¢ Sample managed policies for Lambda:
â€¢ AWSLambdaBasicExecutionRole â€“ Upload logs to CloudWatch.
â€¢ AWSLambdaKinesisExecutionRole â€“ Read from Kinesis
â€¢ AWSLambdaDynamoDBExecutionRole â€“ Read from DynamoDB Streams
â€¢ AWSLambdaSQSQueueExecutionRole â€“ Read from SQS
â€¢ AWSLambdaVPCAccessExecutionRole â€“ Deploy Lambda function in VPC
â€¢ AWSXRayDaemonWriteAccess â€“ Upload trace data to X-Ray.
â€¢ When you use an event source mapping to invoke your function, Lambda
uses the execution role to read event data.
â€¢ Best practice: create one Lambda Execution Role per function
--- ç¬¬33é¡µç»“æŸ ---

```

### ç¬¬34-34é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬34é¡µ
Lambda Resource Based Policies
â€¢ Use resource-based policies to give other accounts and AWS services
permission to use your Lambda resources
â€¢ Similar to S3 bucket policies for S3 bucket
â€¢ An IAM principal can access Lambda:
â€¢ if the IAM policy attached to the principal authorizes it (e.g. user access)
â€¢ OR if the resource-based policy authorizes (e.g. service access)
â€¢ When an AWS service like Amazon S3 calls your Lambda function, the
resource-based policy gives it access.
--- ç¬¬34é¡µç»“æŸ ---

```

### ç¬¬35-35é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬35é¡µ
Lambda Environment Variables
â€¢ Environment variable = key / value pair in â€œStringâ€ form
â€¢ Adjust the function behavior without updating code
â€¢ The environment variables are available to your code
â€¢ Lambda Service adds its own system environment variables as well
â€¢ Helpful to store secrets (encrypted by KMS)
â€¢ Secrets can be encrypted by the Lambda service key, or your own CMK
--- ç¬¬35é¡µç»“æŸ ---

```

### ç¬¬36-36é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬36é¡µ
Lambda Logging & Monitoring
â€¢ CloudWatch Logs:
â€¢ AWS Lambda execution logs are stored in AWS CloudWatch Logs
â€¢ Make sure your AWS Lambda function has an execution role with an IAM
policy that authorizes writes to CloudWatch Logs
â€¢ CloudWatch Metrics:
â€¢ AWS Lambda metrics are displayed in AWS CloudWatch Metrics
â€¢ Invocations, Durations, Concurrent Executions
â€¢ Error count, Success Rates, Throttles
â€¢ Async Delivery Failures
â€¢ Iterator Age (Kinesis & DynamoDB Streams)
--- ç¬¬36é¡µç»“æŸ ---

```

### ç¬¬37-37é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬37é¡µ
Lambda Tracing with X-Ray
â€¢ Enable in Lambda configuration (Active Tracing)
â€¢ Runs the X-Ray daemon for you
â€¢ Use AWS X-Ray SDK in Code
â€¢ Ensure Lambda Function has a correct IAM Execution Role
â€¢ The managed policy is called AWSXRayDaemonWriteAccess
â€¢ Environment variables to communicate with X-Ray
â€¢ _X_AMZN_TRACE_ID: contains the tracing header
â€¢ AWS_XRAY_CONTEXT_MISSING: by default, LOG_ERROR
â€¢ AWS_XRAY_DAEMON_ADDRESS: the X-Ray Daemon IP_ADDRESS:PORT
--- ç¬¬37é¡µç»“æŸ ---

```

### ç¬¬38-38é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬38é¡µ
Customization At The Edge
â€¢ Many modern applications execute some form of the logic at the edge
â€¢ Edge Function:
â€¢ A code that you write and attach to CloudFront distributions
â€¢ Runs close to your users to minimize latency
â€¢ CloudFront provides two types: CloudFront Functions &
Lambda@Edge
â€¢ You donâ€™t have to manage any servers, deployed globally
â€¢ Use case: customize the CDN content
â€¢ Pay only for what you use
â€¢ Fully serverless
--- ç¬¬38é¡µç»“æŸ ---

```

### ç¬¬39-39é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬39é¡µ
CloudFront Functions & Lambda@Edge
Use Cases
â€¢ Website Security and Privacy
â€¢ Dynamic Web Application at the Edge
â€¢ Search Engine Optimization (SEO)
â€¢ Intelligently Route Across Origins and Data Centers
â€¢ Bot Mitigation at the Edge
â€¢ Real-time Image Transformation
â€¢ A/B Testing
â€¢ User Authentication and Authorization
â€¢ User Prioritization
â€¢ User Tracking and Analytics
--- ç¬¬39é¡µç»“æŸ ---

```

### ç¬¬40-40é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬40é¡µ
CloudFront Functions
â€¢ Lightweight functions written in JavaScript
â€¢ For high-scale, latency-sensitive CDN customizations
â€¢ Sub-ms startup times, millions of requests/second
â€¢ Used to change Viewer requests and responses:
â€¢ Viewer Request: after CloudFront receives a request from a
viewer
â€¢ Viewer Response: before CloudFront forwards the response
to the viewer
â€¢ Native feature of CloudFront (manage code entirely
within CloudFront)
Origin
CloudFront
Client
Viewer
Request
Viewer
Response
Origin
Request
Origin
Response
--- ç¬¬40é¡µç»“æŸ ---

```

### ç¬¬41-41é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬41é¡µ
Lambda@Edge
â€¢ Lambda functions written in NodeJS or Python
â€¢ Scales to 1000s of requests/second
â€¢ Used to change CloudFront requests and responses:
â€¢ Viewer Request â€“ after CloudFront receives a request from a
viewer
â€¢ Origin Request â€“ before CloudFront forwards the request to the
origin
â€¢ Origin Response â€“ after CloudFront receives the response from
the origin
â€¢ Viewer Response â€“ before CloudFront forwards the response to
the viewer
â€¢ Author your functions in one AWS Region (us-east-1), then
CloudFront replicates to its locations
Origin
CloudFront
Client
Viewer
Request
Viewer
Response
Origin
Request
Origin
Response
--- ç¬¬41é¡µç»“æŸ ---

```

### ç¬¬42-42é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬42é¡µ
CloudFront Functions vs. Lambda@Edge
CloudFront Funceons
Lambda@Edge
Runtime Support
JavaScript
Node.js, Python
# of Requests
Millions of requests per second
Thousands of requests per second
CloudFront Triggers
-
Viewer Request/Response
-
Viewer Request/Response
-
Origin Request/Response
Max. Execution Time
< 1 ms
5 â€“ 10 seconds
Max. Memory
2 MB
128 MB up to 10 GB
Total Package Size
10 KB
1 MB â€“ 50 MB
Network Access, File System Access
No
Yes
Access to the Request Body
No
Yes
Pricing
Free tier available, 1/6th price of @Edge
No free tier, charged per request & duration
--- ç¬¬42é¡µç»“æŸ ---

```

### ç¬¬43-43é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬43é¡µ
CloudFront Functions vs. Lambda@Edge - Use Cases
CloudFront Functions
â€¢ Cache key normalization
â€¢ Transform request attributes (headers,
cookies, query strings, URL) to create an
optimal Cache Key
â€¢ Header manipulation
â€¢ Insert/modify/delete HTTP headers in the
request or response
â€¢ URL rewrites or redirects
â€¢ Request authentication & authorization
â€¢ Create and validate user-generated
tokens (e.g., JWT) to allow/deny requests
Lambda@Edge
â€¢ Longer execution time (several ms)
â€¢ Adjustable CPU or memory
â€¢ Your code depends on a 3rd
libraries (e.g., AWS SDK to access
other AWS services)
â€¢ Network access to use external
services for processing
â€¢ File system access or access to the
body of HTTP requests
--- ç¬¬43é¡µç»“æŸ ---

```

### ç¬¬44-44é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬44é¡µ
Lambda by default
VPC & Private Subnet
AWS Cloud
Private RDS
DynamoDB
Not working
Default Lambda Deployment
Public
www
works
â€¢ By default, your Lambda function is
launched outside your own VPC (in
an AWS-owned VPC)
â€¢ Therefore it cannot access resources
in your VPC (RDS, ElastiCache,
internal ELBâ€¦)
--- ç¬¬44é¡µç»“æŸ ---

```

### ç¬¬45-45é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬45é¡µ
Private subnet
Lambda in VPC
â€¢ You must define the VPC ID, the
Subnets and the Security Groups
â€¢ Lambda will create an ENI (Elastic
Network Interface) in your subnets
â€¢ AWSLambdaVPCAccessExecutionRol
e
Lambda Function
Amazon RDS
In VPC
Lambda Security group
RDS Security group
Elastic Network
Interface (ENI)
--- ç¬¬45é¡µç»“æŸ ---

```

### ç¬¬46-46é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬46é¡µ
Lambda in VPC â€“ Internet Access
â€¢ A Lambda function in your VPC
does not have internet access
â€¢ Deploying a Lambda function in
a public subnet does not give it
internet access or a public IP
â€¢ Deploying a Lambda function in a
private subnet gives it internet
access if you have a NAT
Gateway / Instance
â€¢ You can use VPC endpoints to
privately access AWS services
without a NAT
VPC & Private Subnet
AWS Cloud
Private RDS
DynamoDB
working
Lambda in VPC
Assign security group
Public subnet
External API
NAT
IGW
Endpoint
Note: Lambda - CloudWatch Logs works even
without endpoint or NAT Gateway
--- ç¬¬46é¡µç»“æŸ ---

```

### ç¬¬47-47é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬47é¡µ
Lambda Function Configuration
â€¢ RAM:
â€¢ From 128MB to 10GB in 1MB increments
â€¢ The more RAM you add, the more vCPU credits you get
â€¢ At 1,792 MB, a function has the equivalent of one full vCPU
â€¢ After 1,792 MB, you get more than one CPU, and need to use multi-threading
in your code to beneï¬t from it (up to 6 vCPU)
â€¢ If your application is CPU-bound (computation heavy), increase RAM
â€¢ Timeout: default 3 seconds, maximum is 900 seconds (15 minutes)
--- ç¬¬47é¡µç»“æŸ ---

```

### ç¬¬48-48é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬48é¡µ
Lambda Execution Context
â€¢ The execution context is a temporary runtime environment that
initializes any external dependencies of your lambda code
â€¢ Great for database connections, HTTP clients, SDK clientsâ€¦
â€¢ The execution context is maintained for some time in anticipation of
another Lambda function invocation
â€¢ The next function invocation can â€œre-useâ€ the context to execution
time and save time in initializing connections objects
â€¢ The execution context includes the /tmp directory
--- ç¬¬48é¡µç»“æŸ ---

```

### ç¬¬49-49é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬49é¡µ
Initialize outside the handler
GOOD!
BAD!
The DB connecDon is established
At every funcDon invocaDon
The DB connection is established once
And re-used across invocations
--- ç¬¬49é¡µç»“æŸ ---

```

### ç¬¬50-50é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬50é¡µ
Lambda Functions /tmp space
â€¢ If your Lambda function needs to download a big file to workâ€¦
â€¢ If your Lambda function needs disk space to perform operationsâ€¦
â€¢ You can use the /tmp directory
â€¢ Max size is 10GB
â€¢ The directory content remains when the execution context is frozen,
providing transient cache that can be used for multiple invocations
(helpful to checkpoint your work)
â€¢ For permanent persistence of object (non temporary), use S3
â€¢ To encrypt content on /tmp, you must generate KMS Data Keys
--- ç¬¬50é¡µç»“æŸ ---

```

### ç¬¬51-51é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬51é¡µ
Lambda Layers
â€¢ Custom Runtimes
â€¢ Ex: C++ https://github.com/awslabs/aws-lambda-cpp
â€¢ Ex: Rust https://github.com/awslabs/aws-lambda-rust-runtime
â€¢ Externalize Dependencies to re-use them:
lambda_funcxon_1.py
Application Package 1 (20KB)
lambda_funcxon_2.py
Application Package 1 (60KB)
Lambda Layer 1 (10 MB)
my_heavy_library_1 ï¬les
Lambda Layer 2 (30 MB)
my_heavy_library_2 files
lambda_function_1.py
+
my_heavy_library_1 files
+
my_heavy_library_2 files
Application Package 1 (30.02MB)
--- ç¬¬51é¡µç»“æŸ ---

```

### ç¬¬52-52é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬52é¡µ
Lambda â€“ File Systems Mounting
â€¢ Lambda functions can access EFS file
systems if they are running in a VPC
â€¢ Configure Lambda to mount EFS file
systems to local directory during
initialization
â€¢ Must leverage EFS Access Points
â€¢ Limitations: watch out for the EFS
connection limits (one function instance =
one connection) and connection burst
limits
VPC
Availability Zone A
Availability Zone B
Private Subnet A
Private Subnet B
EFS File System
EFS Access Point
Path: /
--- ç¬¬52é¡µç»“æŸ ---

```

### ç¬¬53-53é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬53é¡µ
Lambda â€“ Storage Options
Ephemeral Storage /tmp
Lambda Layers
Amazon S3
Amazon EFS
Max. Size
10,240 MB
5 layers per
function up to
250MB total
Elastic
Elastic
Persistence
Ephemeral
Durable
Durable
Durable
Content
Dynamic
Static
Dynamic
Dynamic
Storage Type
File System
Archive
Object
File System
Operations supported
any File System operation
Immutable
Atomic with Versioning
any File System operation
Pricing
Included in Lambda
Included in
Lambda
Storage + Requests +
Data Transfer
Storage + Data Transfer +
Throughput
Sharing/Permissions
Function Only
IAM
IAM
IAM + NFS
Relative Data Access
Speed from Lambda
Fastest
Fastest
Fast
Very Fast
Shared Across All
Invocations
No
Yes
Yes
Yes
--- ç¬¬53é¡µç»“æŸ ---

```

### ç¬¬54-54é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬54é¡µ
Lambda Concurrency and Throttling
â€¢ Concurrency limit: up to 1000 concurrent executions
â€¢ Can set a â€œreserved concurrencyâ€ at the function level (=limit)
â€¢ Each invocation over the concurrency limit will trigger a â€œThrottleâ€
â€¢ Throttle behavior:
â€¢ If synchronous invocation => return ThrottleError - 429
â€¢ If asynchronous invocation => retry automatically and then go to DLQ
â€¢ If you need a higher limit, open a support ticket
--- ç¬¬54é¡µç»“æŸ ---

```

### ç¬¬55-55é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬55é¡µ
Lambda Concurrency Issue
â€¢ If you donâ€™t reserve (=limit) concurrency, the following can happen:
Applicaeon Load Balancer
API Gateway
SDK / CLI
1000 concurrent
executions
THROTTLE!
THROTTLE!
Many users
Few users
--- ç¬¬55é¡µç»“æŸ ---

```

### ç¬¬56-56é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬56é¡µ
Concurrency and Asynchronous Invocations
S3 bucket
New file event
New file event
New ï¬le event
â€¢ If the function doesn't have enough
concurrency available to process all
events, additional requests are
throttled.
â€¢ For throttling errors (429) and
system errors (500-series), Lambda
returns the event to the queue and
attempts to run the function again
for up to 6 hours.
â€¢ The retry interval increases
exponentially from 1 second after
the first attempt to a maximum of
5 minutes.
--- ç¬¬56é¡µç»“æŸ ---

```

### ç¬¬57-57é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬57é¡µ
Cold Starts & Provisioned Concurrency
â€¢ Cold Start:
â€¢ New instance => code is loaded and code outside the handler run (init)
â€¢ If the init is large (code, dependencies, SDKâ€¦) this process can take some time.
â€¢ First request served by new instances has higher latency than the rest
â€¢ Provisioned Concurrency:
â€¢ Concurrency is allocated before the function is invoked (in advance)
â€¢ So the cold start never happens and all invocations have low latency
â€¢ Application Auto Scaling can manage concurrency (schedule or target utilization)
â€¢ Note:
â€¢ Note: cold starts in VPC have been dramatically reduced in Oct & Nov 2019
â€¢ https://aws.amazon.com/blogs/compute/announcing-improved-vpc-networking-for-aws-lambda-functions/
--- ç¬¬57é¡µç»“æŸ ---

```

### ç¬¬58-58é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬58é¡µ
Reserved and Provisioned Concurrency
https://docs.aws.amazon.com/lambda/latest/dg/configuration-concurrency.html
--- ç¬¬58é¡µç»“æŸ ---

```

### ç¬¬59-59é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬59é¡µ
Lambda Function Dependencies
â€¢ If your Lambda function depends on external libraries:
for example AWS X-Ray SDK, Database Clients, etcâ€¦
â€¢ You need to install the packages alongside your code and zip it
together
â€¢ For Node.js, use npm & â€œnode_modulesâ€ directory
â€¢ For Python, use pip --target options
â€¢ For Java, include the relevant .jar files
â€¢ Upload the zip straight to Lambda if less than 50MB, else to S3 first
â€¢ Native libraries work: they need to be compiled on Amazon Linux
â€¢ AWS SDK comes by default with every Lambda function
--- ç¬¬59é¡µç»“æŸ ---

```

### ç¬¬60-60é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬60é¡µ
Lambda and CloudFormation â€“ inline
â€¢ Inline functions are very
simple
â€¢ Use the Code.ZipFile
property
â€¢ You cannot include function
dependencies with inline
functions
--- ç¬¬60é¡µç»“æŸ ---

```

### ç¬¬61-61é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬61é¡µ
Lambda and CloudFormation â€“ through S3
â€¢ You must store the Lambda zip in S3
â€¢ You must refer the S3 zip location in
the CloudFormation code
â€¢ S3Bucket
â€¢ S3Key: full path to zip
â€¢ S3ObjectVersion: if versioned bucket
â€¢ If you update the code in S3, but
donâ€™t update S3Bucket, S3Key or
S3ObjectVersion, CloudFormation
wonâ€™t update your function
--- ç¬¬61é¡µç»“æŸ ---

```

### ç¬¬62-62é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬62é¡µ
Lambda and CloudFormation â€“ through S3
Multiple accounts
S3 bucket with
Lambda Code
Account 1
Account 3
CloudFormation
Execution Role
Allow get & list
To S3 bucket
Bucket policy
Allow Principal: [Accounts IDâ€¦]
Account 2
CloudFormation
Execution Role
--- ç¬¬62é¡µç»“æŸ ---

```

### ç¬¬63-63é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬63é¡µ
Lambda Container Images
â€¢ Deploy Lambda function as container
images of up to 10GB from ECR
â€¢ Pack complex dependencies, large
dependencies in a container
â€¢ Base images are available for Python,
Node.js, Java, .NET, Go, Ruby
â€¢ Can create your own image as long as it
implements the Lambda Runtime API
â€¢ Test the containers locally using the
Lambda Runtime Interface Emulator
â€¢ Uniï¬ed workï¬‚ow to build apps
Application Code
Dependencies, datasets
Base Image must implement the
Lambda Runtime API
Amazon ECR
Build
Publish
Deploy
Lambda
--- ç¬¬63é¡µç»“æŸ ---

```

### ç¬¬64-64é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬64é¡µ
Lambda Container Images
â€¢ Example: build from the base images provided by AWS
# Use an image that implements the Lambda Runtime API
FROM amazon/aws-lambda-nodejs:12
# Copy your application code and files
COPY app.js package*.json ./
# Install the dependencies in the container
RUN npm install
# Function to run when the Lambda function is invoked
CMD [ "app.lambdaHandler" ]
--- ç¬¬64é¡µç»“æŸ ---

```

### ç¬¬65-65é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬65é¡µ
Lambda Container Images â€“ Best Practices
â€¢ Strategies for optimizing container images:
â€¢ Use AWS-provided Base Images
â€¢ Stable, Built on Amazon Linux 2, cached by Lambda service
â€¢ Use Multi-Stage Builds
â€¢ Build your code in larger preliminary images, copy only the artifacts you need in your final
container image, discard the preliminary steps
â€¢ Build from Stable to Frequently Changing
â€¢ Make your most frequently occurring changes as late in your Dockerfile as possible
â€¢ Use a Single Repository for Functions with Large Layers
â€¢ ECR compares each layer of a container image when it is pushed to avoid uploading and
storing duplicates
â€¢ Use them to upload large Lambda Functions (up to 10 GB)
--- ç¬¬65é¡µç»“æŸ ---

```

### ç¬¬66-66é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬66é¡µ
AWS Lambda Versions
â€¢ When you work on a Lambda function,
we work on $LATEST
â€¢ When weâ€™re ready to publish a Lambda
function, we create a version
â€¢ Versions are immutable
â€¢ Versions have increasing version numbers
â€¢ Versions get their own ARN (Amazon
Resource Name)
â€¢ Version = code + conï¬guration (nothing
can be changed - immutable)
â€¢ Each version of the lambda function can
be accessed
$LATEST
(mutable)
V1
(Immutable)
V2
(Immutable)
--- ç¬¬66é¡µç»“æŸ ---

```

### ç¬¬67-67é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬67é¡µ
AWS Lambda Aliases
â€¢ Aliases are â€pointersâ€ to Lambda
function versions
â€¢ We can define a â€œdevâ€, â€testâ€,
â€œprodâ€ aliases and have them point
at different lambda versions
â€¢ Aliases are mutable
â€¢ Aliases enable Canary deployment
by assigning weights to lambda
functions
â€¢ Aliases enable stable configuration
of our event triggers / destinations
â€¢ Aliases have their own ARNs
â€¢ Aliases cannot reference aliases
V1
(Immutable)
V2
(Immutable)
$LATEST
(mutable)
TEST Alias
(mutable)
DEV Alias
(mutable)
PROD Alias
(mutable)
Users
95%
5%
--- ç¬¬67é¡µç»“æŸ ---

```

### ç¬¬68-68é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬68é¡µ
Lambda & CodeDeploy
â€¢ CodeDeploy can help you automate
trafï¬c shift for Lambda aliases
â€¢ Feature is integrated within the SAM
framework
â€¢ Linear: grow trafï¬c every N minutes until
100%
â€¢ Linear10PercentEvery3Minutes
â€¢ Linear10PercentEvery10Minutes
â€¢ Canary: try X percent then 100%
â€¢ Canary10Percent5Minutes
â€¢ Canary10Percent30Minutes
â€¢ AllAtOnce: immediate
â€¢ Can create Pre & Post Trafï¬c hooks to
check the health of the Lambda function
PROD Alias
V1
V2
CodeDeploy
100 â€“ X%
X%
Make X vary over time until X = 100%
--- ç¬¬68é¡µç»“æŸ ---

```

### ç¬¬69-69é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬69é¡µ
Lambda & CodeDeploy â€“ AppSpec.yml
â€¢ Name (required) â€“ the name of the Lambda
function to deploy
â€¢ Alias (required) â€“ the name of the alias to
the Lambda function
â€¢ CurrentVersion (required) â€“ the version of
the Lambda function trafï¬c currently points to
â€¢ TargetVersion (required) â€“ the version of
the Lambda function trafï¬c is shifted to
--- ç¬¬69é¡µç»“æŸ ---

```

### ç¬¬70-70é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬70é¡µ
Lambda â€“ Function URL
â€¢ Dedicated HTTP(S) endpoint for your Lambda function
â€¢ A unique URL endpoint is generated for you (never changes)
â€¢ https://<url-id>.lambda-url.<region>.on.aws (dual-stack IPv4 & IPv6)
â€¢ Invoke via a web browser, curl, Postman, or any HTTP client
â€¢ Access your function URL through the public Internet only
â€¢ Doesnâ€™t support PrivateLink (Lambda functions do support)
â€¢ Supports Resource-based Policies & CORS configurations
â€¢ Can be applied to any function alias or to $LATEST (canâ€™t be
applied to other function versions)
â€¢ Create and configure using AWS Console or AWS API
â€¢ Throttle your function by using Reserved Concurrency
Client
Lambda Function
https://yj4xbxeirvacv3xdjp5uyt3j7y0ltzqa.
lambda-url.us-east-1.on.aws/
HTTPS request
--- ç¬¬70é¡µç»“æŸ ---

```

### ç¬¬71-71é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬71é¡µ
Lambda â€“ Function URL Security
â€¢ Resource-based Policy
â€¢ Authorize other accounts / specific CIDR / IAM principals
â€¢ Cross-Origin Resource Sharing (CORS)
â€¢ If you call your Lambda function URL from a different domain
CloudFront
S3 Bucket
(Static Website Hosting)
Users
example.com
Lambda Funcxon URL
api.example.com
--- ç¬¬71é¡µç»“æŸ ---

```

### ç¬¬72-72é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬72é¡µ
Lambda â€“ Function URL Security
â€¢ AuthType NONE â€“ allow public and unauthenticated access
â€¢ Resource-based Policy is always in effect (must grant public access)
Account A
(123456789012)
Lambda Function
(my-function)
Users
Internet
Resource-based Policy
--- ç¬¬72é¡µç»“æŸ ---

```

### ç¬¬73-73é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬73é¡µ
Lambda â€“ Function URL Security
â€¢ AuthType AWS_IAM â€“ IAM is used to authenticate and authorize requests
â€¢ Both Principalâ€™s Identity-based Policy & Resource-based Policy are evaluated
â€¢ Principal must have lambda:InvokeFunctionUrl permissions
â€¢ Same account â€“ Identity-based Policy OR Resource-based Policy as ALLOW
â€¢ Cross account â€“ Identity-based Policy AND Resource Based Policy as ALLOW
Account A
(123456789012)
Lambda Funcoon
(my-funclon)
Account B
(444455556666)
Resource-based Policy
IAM Role
(my-role)
Identity-based Policy
--- ç¬¬73é¡µç»“æŸ ---

```

### ç¬¬74-74é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬74é¡µ
Lambda and CodeGuru Profiling
â€¢ Gain insights into runtime performance of your Lambda
functions using CodeGuru Proï¬ler
â€¢ CodeGuru creates a Proï¬ler Group for your Lambda function
â€¢ Supported for Java and Python runtimes
â€¢ Activate from AWS Lambda Console
â€¢ When activated, Lambda adds:
â€¢ CodeGuru Proï¬ler layer to your function
â€¢ Environment variables to your function
â€¢ AmazonCodeGuruProï¬lerAgentAccess policy to your function
+
Lambda Funcxon
(MyFunclon)
CodeGuru Profiler
(aws-lambda-MyFunction)
runtime
performance
insighs
--- ç¬¬74é¡µç»“æŸ ---

```

### ç¬¬75-75é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬75é¡µ
AWS Lambda Limits to Know - per region
â€¢ Execution:
â€¢ Memory allocation: 128 MB â€“ 10GB (1 MB increments)
â€¢ Maximum execution time: 900 seconds (15 minutes)
â€¢ Environment variables (4 KB)
â€¢ Disk capacity in the â€œfunction containerâ€ (in /tmp): 512 MB to 10GB
â€¢ Concurrency executions: 1000 (can be increased)
â€¢ Deployment:
â€¢ Lambda function deployment size (compressed .zip): 50 MB
â€¢ Size of uncompressed deployment (code + dependencies): 250 MB
â€¢ Can use the /tmp directory to load other ï¬les at startup
â€¢ Size of environment variables: 4 KB
--- ç¬¬75é¡µç»“æŸ ---

```

### ç¬¬76-76é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬76é¡µ
AWS Lambda Best Practices
â€¢ Perform heavy-duty work outside of your function handler
â€¢ Connect to databases outside of your function handler
â€¢ Initialize the AWS SDK outside of your function handler
â€¢ Pull in dependencies or datasets outside of your function handler
â€¢ Use environment variables for:
â€¢ Database Connection Strings, S3 bucket, etcâ€¦ donâ€™t put these values in your code
â€¢ Passwords, sensitive valuesâ€¦ they can be encrypted using KMS
â€¢ Minimize your deployment package size to its runtime necessities.
â€¢ Break down the function if need be
â€¢ Remember the AWS Lambda limits
â€¢ Use Layers where necessary
â€¢ Avoid using recursive code, never have a Lambda function call itself
--- ç¬¬76é¡µç»“æŸ ---

```

### ç¬¬77-77é¡µ

```
ä½ å°†æ¥æ”¶åˆ°ä¸€é¡µè‹±è¯­åŸæ–‡ï¼Œä½œä¸ºå°ç™½ï¼Œæˆ‘å®Œå…¨çœ‹ä¸æ‡‚è®°ä¸ä½å•Šï¼Œæ€ä¹ˆåŠï¼Ÿ
è§£é‡Šæ—¶ï¼Œå…ˆæä¾›å¦‚ä¸‹å†…å®¹
1. æ ¼å¼åŒ–å¥½çš„åŸæ–‡ï¼Œ
2. æ ¼å¼åŒ–ååŸæ–‡åŠå…¶é€å¥å¯¹åº”çš„å›½é™…éŸ³æ ‡
3. åŸæ–‡çš„ä¸­æ–‡ç¿»è¯‘ï¼Œ
4. ç¼©å†™è¯¦è§£ï¼Œ
5. è‹±è¯­å…³é”®è¯è¯¦è§£ï¼Œ
6. é€Ÿè§ˆç‰ˆï¼ˆ30 ç§’å†…èƒ½è¯»å®Œï¼‰
ğŸ”‘ æœ¬é¡µé‡ç‚¹ï¼šä¸€å¥è¯æ€»ç»“
ğŸ“Œ å…³é”®è¯ï¼šæ ¸å¿ƒæœ¯è¯­
ğŸ¯ å­¦ä¹ æç¤ºï¼šæœ€å¯èƒ½å‡ºç°åœ¨è€ƒè¯•é‡Œçš„è€ƒç‚¹
7. å†é€šä¿—æ˜“æ‡‚çš„è§£é‡Šä¸€éï¼Œ
8. å°ç™½ä¹Ÿæ‡‚çš„è¯­è¨€å†è§£é‡Šä¸€éï¼Œ
9. æä¾›å°ç»“ï¼Œ
10. è®°å¿†å£è¯€ã€‚
è‹±è¯­åŸæ–‡å†…å®¹å¦‚ä¸‹ï¼š

ğŸŸ© ç¬¬77é¡µ
Amazon DynamoDB
NoSQL Serverless Database
--- ç¬¬77é¡µç»“æŸ ---

```